<!DOCTYPE html>
<html lang="en" class="h-full bg-slate-950 text-slate-100">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SAF HUB - West Africa's SAF Market Intelligence Platform</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', system-ui, -apple-system, sans-serif; }
    .glass { background: rgba(15, 23, 42, 0.75); border: 1px solid rgba(148, 163, 184, 0.15); box-shadow: 0 20px 80px rgba(8, 47, 73, 0.35); backdrop-filter: blur(12px); }

    /* Toggle Switch Styles */
    .toggle-switch { position: relative; display: inline-block; width: 44px; height: 24px; }
    .toggle-switch input { opacity: 0; width: 0; height: 0; }
    .toggle-slider {
      position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
      background-color: #475569; border-radius: 24px; transition: 0.3s;
    }
    .toggle-slider:before {
      position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px;
      background-color: white; border-radius: 50%; transition: 0.3s;
    }
    input:checked + .toggle-slider { background-color: #10b981; }
    input:checked + .toggle-slider:before { transform: translateX(20px); }
  </style>
</head>
<body class="h-full">
  <div class="min-h-screen flex flex-col bg-gradient-to-b from-slate-950 via-slate-900 to-slate-950">
    <!-- Demo Mode Banner -->
    <div id="demo-banner" class="hidden bg-gradient-to-r from-amber-500/20 via-orange-500/20 to-amber-500/20 border-b border-amber-500/30 py-2 px-6">
      <div class="max-w-6xl mx-auto flex items-center justify-center gap-2 text-sm">
        <span class="text-amber-200">ðŸ“Š Demo Mode</span>
        <span class="text-amber-100/80">â€”</span>
        <span class="text-slate-300">Sample data shown for illustration</span>
      </div>
    </div>

    <header class="relative overflow-hidden">
      <div class="absolute inset-0 bg-[radial-gradient(circle_at_20%_20%,rgba(52,211,153,0.15),transparent_25%),radial-gradient(circle_at_80%_0%,rgba(59,130,246,0.12),transparent_25%)]"></div>
      <div class="max-w-6xl mx-auto px-6 py-14 relative z-10">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div class="h-12 w-12 rounded-2xl bg-gradient-to-tr from-emerald-400 via-cyan-400 to-blue-500 flex items-center justify-center text-slate-900 font-bold shadow-lg shadow-emerald-500/30">SH</div>
            <div>
              <p class="text-sm uppercase tracking-[0.22em] text-emerald-300/80">SAF HUB</p>
              <h1 class="text-3xl md:text-4xl font-semibold text-slate-50">West Africa's SAF Market Intelligence Platform</h1>
            </div>
          </div>
          <div class="flex items-center gap-4">
            <div class="flex items-center gap-2 bg-slate-800/50 px-3 py-2 rounded-xl border border-slate-700/50">
              <span class="text-xs text-slate-300">Demo Mode</span>
              <label class="toggle-switch">
                <input type="checkbox" id="demo-mode-toggle" checked>
                <span class="toggle-slider"></span>
              </label>
            </div>
            <a href="https://www.linkedin.com/company/biojet-nigeria-limited/" class="hidden md:inline-flex items-center px-4 py-2 rounded-xl text-sm font-medium bg-gradient-to-r from-emerald-500 to-blue-500 text-slate-900 shadow-md shadow-emerald-500/30 hover:-translate-y-0.5 transition">LinkedIn</a>
          </div>
        </div>
        <div class="mt-12 grid md:grid-cols-2 gap-8 items-center">
          <div class="space-y-6">
            <p class="text-4xl md:text-5xl font-semibold leading-tight text-slate-50">Accelerating Decarbonization of West African Aviation</p>
            <p class="text-lg text-slate-300 max-w-2xl">Real-time insight on biomass economics, regulatory shifts, and capital signals driving sustainable aviation fuel deployment across Nigeria and West Africa.</p>
            <div class="flex flex-wrap gap-4">
              <a href="https://www.linkedin.com/company/biojet-nigeria-limited/" class="inline-flex items-center px-4 py-2 rounded-xl text-sm font-medium bg-emerald-500 text-slate-900 shadow-md shadow-emerald-500/30 hover:-translate-y-0.5 transition">Connect on LinkedIn</a>
              <span class="inline-flex items-center px-4 py-2 rounded-xl text-sm font-medium border border-slate-700 text-slate-200">Live intelligence Â· Updated daily</span>
            </div>
          </div>
          <div class="glass rounded-2xl p-6 border border-emerald-500/20">
            <div class="flex items-center gap-3 pb-4 border-b border-slate-800">
              <span class="h-3 w-3 rounded-full bg-emerald-400 animate-pulse"></span>
              <p class="text-sm uppercase tracking-[0.18em] text-emerald-200">Operational Intelligence</p>
            </div>
            <ul class="divide-y divide-slate-800 text-sm mt-4">
              <li class="py-3 flex items-center justify-between">
                <div>
                  <p class="text-slate-200 font-medium">Supply Stack Monitoring</p>
                  <p class="text-slate-400">Feedstock economics, yield viability, aggregation signals</p>
                </div>
                <span class="px-3 py-1 rounded-full bg-emerald-500/20 text-emerald-200 text-xs">Stable</span>
              </li>
              <li class="py-3 flex items-center justify-between">
                <div>
                  <p class="text-slate-200 font-medium">Policy &amp; Certs</p>
                  <p class="text-slate-400">ICAO, NCAA, and emerging SAF incentives</p>
                </div>
                <span class="px-3 py-1 rounded-full bg-blue-500/20 text-blue-200 text-xs">Tracking</span>
              </li>
              <li class="py-3 flex items-center justify-between">
                <div>
                  <p class="text-slate-200 font-medium">Capital Formation</p>
                  <p class="text-slate-400">Project finance, grants, concessional capital</p>
                </div>
                <span class="px-3 py-1 rounded-full bg-amber-500/20 text-amber-200 text-xs">New</span>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </header>

    <main class="flex-1">
      <section class="max-w-6xl mx-auto px-6 mt-12">
        <div class="grid md:grid-cols-3 gap-6">
          <div class="glass rounded-2xl p-5 border border-emerald-500/20">
            <p class="text-sm text-slate-400">Biomass Price Index</p>
            <h3 class="text-3xl font-semibold text-emerald-300 mt-2" id="latest-price">â‚¦--,---</h3>
            <p class="text-xs text-slate-500 mt-1" id="last-updated">Loading...</p>
            <p class="text-xs text-slate-500 mt-2">Median cassava peel &amp; residue value per tonne (monitoring weekly volatility).</p>
          </div>
          <div class="glass rounded-2xl p-5 border border-blue-500/20">
            <p class="text-sm text-slate-400">Regulatory Alerts</p>
            <h3 class="text-3xl font-semibold text-blue-300 mt-2" id="alerts-count">--</h3>
            <p class="text-xs text-slate-500 mt-1" id="alerts-summary">Loading...</p>
            <p class="text-xs text-slate-500 mt-2">Latest updates from ICAO, EASA, NCAA and regional aviation authorities.</p>
          </div>
          <div class="glass rounded-2xl p-5 border border-emerald-500/20">
            <p class="text-sm text-slate-400">Funding Tracker</p>
            <h3 class="text-3xl font-semibold text-emerald-300 mt-2">7</h3>
            <p class="text-xs text-slate-500 mt-3">Active SAF-linked pipelines including concessional debt, grants, and blended finance.</p>
          </div>
        </div>
      </section>

      <section class="max-w-6xl mx-auto px-6 mt-12">
        <div class="glass rounded-2xl p-6 border border-blue-500/20">
          <div class="flex items-center gap-3 mb-6">
            <div class="h-10 w-10 rounded-xl bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center text-slate-900 font-semibold">PR</div>
            <div>
              <p class="text-sm uppercase tracking-[0.14em] text-blue-200">Policy Radar</p>
              <h2 class="text-2xl font-semibold text-slate-50">Latest Regulatory Updates</h2>
            </div>
          </div>
          <div id="regulatory-alerts-list" class="space-y-4">
            <p class="text-slate-400 text-sm">Loading regulatory alerts...</p>
          </div>
        </div>
      </section>

      <section class="max-w-6xl mx-auto px-6 mt-12 grid lg:grid-cols-2 gap-8 items-start">
        <div class="glass rounded-2xl p-6 border border-slate-800">
          <div class="flex items-center gap-3 mb-4">
            <div class="h-10 w-10 rounded-xl bg-gradient-to-br from-emerald-500 to-blue-500 flex items-center justify-center text-slate-900 font-semibold">NG</div>
            <div>
              <p class="text-sm uppercase tracking-[0.14em] text-emerald-200">Nigerian SAF Opportunity</p>
              <h2 class="text-2xl font-semibold text-slate-50">Cassava-driven circular feedstock</h2>
            </div>
          </div>
          <p class="text-slate-300 leading-relaxed">Cassava processing yields substantial peel and pulp residues that can be valorized into ethanol and SAF pathways. Nigeria produces over <span class="text-emerald-300 font-semibold">60M tonnes</span> of cassava annually, positioning the country as a strategic supplier for West African decarbonization.</p>
          <div class="mt-6 grid grid-cols-3 gap-4 text-center">
            <div class="glass rounded-xl p-4 border border-emerald-500/10">
              <p class="text-xs text-slate-400">Cassava Output</p>
              <p class="text-2xl font-semibold text-emerald-300">60M</p>
              <p class="text-[11px] text-slate-500">tonnes / year</p>
            </div>
            <div class="glass rounded-xl p-4 border border-emerald-500/10">
              <p class="text-xs text-slate-400">Residue Recovery</p>
              <p class="text-2xl font-semibold text-blue-300">35%</p>
              <p class="text-[11px] text-slate-500">collection efficiency</p>
            </div>
            <div class="glass rounded-xl p-4 border border-emerald-500/10">
              <p class="text-xs text-slate-400">SAF Yield</p>
              <p class="text-2xl font-semibold text-emerald-300">9-12%</p>
              <p class="text-[11px] text-slate-500">conversion pathway</p>
            </div>
          </div>
        </div>

        <div class="glass rounded-2xl p-6 border border-slate-800">
          <div class="flex items-center gap-3 mb-4">
            <div class="h-10 w-10 rounded-xl bg-gradient-to-br from-blue-500 to-emerald-500 flex items-center justify-center text-slate-900 font-semibold">AI</div>
            <div>
              <p class="text-sm uppercase tracking-[0.14em] text-emerald-200">Intelligence Agents</p>
              <h2 class="text-2xl font-semibold text-slate-50">Status &amp; Signal Quality</h2>
            </div>
          </div>
          <div class="grid sm:grid-cols-2 gap-4">
            <div class="glass rounded-xl p-4 border border-emerald-500/15 flex items-center justify-between">
              <div>
                <p class="text-sm font-medium text-slate-200">Feedstock Watchdog</p>
                <p class="text-xs text-slate-500">Cassava peel &amp; ag-residue pricing</p>
              </div>
              <span class="px-3 py-1 rounded-full bg-emerald-500/20 text-emerald-200 text-xs">Online</span>
            </div>
            <div class="glass rounded-xl p-4 border border-blue-500/15 flex items-center justify-between">
              <div>
                <p class="text-sm font-medium text-slate-200">Policy Radar</p>
                <p class="text-xs text-slate-500">ICAO CORSIA, NCAA &amp; ECOWAS updates</p>
              </div>
              <span class="px-3 py-1 rounded-full bg-blue-500/20 text-blue-200 text-xs">Tracking</span>
            </div>
            <div class="glass rounded-xl p-4 border border-emerald-500/15 flex items-center justify-between">
              <div>
                <p class="text-sm font-medium text-slate-200">Capital Signals</p>
                <p class="text-xs text-slate-500">Grants, concessional debt, blended stacks</p>
              </div>
              <span class="px-3 py-1 rounded-full bg-emerald-500/20 text-emerald-200 text-xs">Live</span>
            </div>
            <div class="glass rounded-xl p-4 border border-blue-500/15 flex items-center justify-between">
              <div>
                <p class="text-sm font-medium text-slate-200">Technology Diligence</p>
                <p class="text-xs text-slate-500">HEFA/ETJ benchmarks &amp; pathway economics</p>
              </div>
              <span class="px-3 py-1 rounded-full bg-amber-500/20 text-amber-200 text-xs">Reviewing</span>
            </div>
            <div class="glass rounded-xl p-4 border border-emerald-500/15 flex items-center justify-between">
              <div>
                <p class="text-sm font-medium text-slate-200">Market Access</p>
                <p class="text-xs text-slate-500">Offtake readiness &amp; airline engagement</p>
              </div>
              <span class="px-3 py-1 rounded-full bg-emerald-500/20 text-emerald-200 text-xs">Stable</span>
            </div>
            <div class="glass rounded-xl p-4 border border-blue-500/15 flex items-center justify-between">
              <div>
                <p class="text-sm font-medium text-slate-200">Community Pulse</p>
                <p class="text-xs text-slate-500">Aggregator sentiment &amp; logistics friction</p>
              </div>
              <span class="px-3 py-1 rounded-full bg-blue-500/20 text-blue-200 text-xs">Listening</span>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="mt-16 border-t border-slate-800/80 bg-slate-950/80">
      <div class="max-w-6xl mx-auto px-6 py-8 flex flex-col md:flex-row items-start md:items-center justify-between gap-4">
        <div>
          <p class="text-slate-300 font-medium">Biojet Nigeria Limited</p>
          <p class="text-sm text-slate-500 mt-1">Biojet Nigeria Limited is a research-focused entity. We do not currently offer commercial consultancy services.</p>
        </div>
        <div class="flex items-center gap-3">
          <a href="https://www.linkedin.com/company/biojet-nigeria-limited/" class="text-sm text-emerald-300 hover:text-emerald-200">LinkedIn</a>
          <span class="text-slate-700">â€¢</span>
          <span class="text-xs text-slate-500">Updated daily at 08:00 UTC</span>
        </div>
      </div>
    </footer>
  </div>

  <script>
    // Demo Mode Toggle Management
    let isDemoMode = true;

    function initDemoMode() {
      // Load preference from localStorage (default to true/demo mode)
      const saved = localStorage.getItem('safhub-demo-mode');
      isDemoMode = saved === null ? true : saved === 'true';

      // Set toggle state
      const toggle = document.getElementById('demo-mode-toggle');
      toggle.checked = isDemoMode;

      // Update banner visibility
      updateDemoBanner();

      // Add event listener
      toggle.addEventListener('change', function() {
        isDemoMode = this.checked;
        localStorage.setItem('safhub-demo-mode', isDemoMode);
        updateDemoBanner();
        // Reload all data
        loadLatestPrice();
        loadRegulatoryAlerts();
      });
    }

    function updateDemoBanner() {
      const banner = document.getElementById('demo-banner');
      if (isDemoMode) {
        banner.classList.remove('hidden');
      } else {
        banner.classList.add('hidden');
      }
    }

    // Fetch and display latest cassava peel price from data/prices.json
    async function loadLatestPrice() {
      try {
        const response = await fetch('data/prices.json');
        if (!response.ok) throw new Error('Failed to fetch price data');

        let prices = await response.json();

        // Filter by mode
        if (!isDemoMode) {
          prices = prices.filter(p => p.mode === 'live');
        }

        // Check if we have data
        if (prices.length === 0) {
          document.getElementById('latest-price').textContent = 'â‚¦--,---';
          document.getElementById('last-updated').textContent = 'No live data yet â€” agents collecting daily';
          return;
        }

        // Find the most recent entry (latest timestamp)
        const latestEntry = prices.reduce((latest, current) => {
          return new Date(current.timestamp) > new Date(latest.timestamp) ? current : latest;
        });

        // Format price with thousands separator
        const formattedPrice = 'â‚¦' + latestEntry.price_per_tonne.toLocaleString('en-NG');

        // Determine badge
        const isLive = latestEntry.mode === 'live';
        const badge = isLive
          ? '<span class="ml-2 px-2 py-0.5 rounded-md bg-emerald-500/20 text-emerald-200 text-xs font-medium">LIVE</span>'
          : '<span class="ml-2 px-2 py-0.5 rounded-md bg-slate-500/20 text-slate-400 text-xs font-medium">DEMO</span>';

        // Format timestamp
        const date = new Date(latestEntry.timestamp);
        const formattedDate = date.toLocaleDateString('en-US', {
          year: 'numeric',
          month: 'short',
          day: 'numeric'
        });
        const formattedTime = date.toLocaleTimeString('en-US', {
          hour: '2-digit',
          minute: '2-digit',
          hour12: false
        });

        // Update DOM
        document.getElementById('latest-price').innerHTML = formattedPrice + badge;
        document.getElementById('last-updated').textContent = `Last updated: ${formattedDate} at ${formattedTime} UTC`;

      } catch (error) {
        console.error('Error loading price data:', error);
        document.getElementById('latest-price').textContent = 'â‚¦--,---';
        document.getElementById('last-updated').textContent = 'Unable to load latest price';
      }
    }

    // Fetch and display latest regulatory alerts from data/regulatory_alerts.json
    async function loadRegulatoryAlerts() {
      try {
        const response = await fetch('data/regulatory_alerts.json');
        if (!response.ok) throw new Error('Failed to fetch regulatory alerts');

        let alerts = await response.json();

        // Filter by mode
        if (!isDemoMode) {
          alerts = alerts.filter(a => a.mode === 'live');
        }

        // Check if we have data
        if (alerts.length === 0) {
          document.getElementById('alerts-count').textContent = '--';
          document.getElementById('alerts-summary').textContent = 'No live data yet';
          document.getElementById('regulatory-alerts-list').innerHTML =
            '<p class="text-slate-400 text-sm">No live data yet â€” agents collecting daily at 08:00 UTC</p>';
          return;
        }

        // Sort by timestamp (most recent first) and take latest 5
        const sortedAlerts = alerts.sort((a, b) =>
          new Date(b.timestamp) - new Date(a.timestamp)
        ).slice(0, 5);

        // Update count and summary
        document.getElementById('alerts-count').textContent = alerts.length;
        const latestDate = new Date(sortedAlerts[0].timestamp).toLocaleDateString('en-US', {
          month: 'short',
          day: 'numeric'
        });
        document.getElementById('alerts-summary').textContent = `Last update: ${latestDate}`;

        // Build alerts HTML
        const alertsList = document.getElementById('regulatory-alerts-list');
        alertsList.innerHTML = sortedAlerts.map(alert => {
          const date = new Date(alert.timestamp);
          const formattedDate = date.toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'short',
            day: 'numeric'
          });

          // Source badge colors
          const badgeColors = {
            'ICAO': 'bg-blue-500/20 text-blue-200',
            'EASA': 'bg-cyan-500/20 text-cyan-200',
            'NCAA': 'bg-emerald-500/20 text-emerald-200'
          };
          const badgeClass = badgeColors[alert.source] || 'bg-slate-500/20 text-slate-200';

          // Mode badge
          const isLive = alert.mode === 'live';
          const modeBadge = isLive
            ? '<span class="px-2 py-0.5 rounded-md bg-emerald-500/20 text-emerald-200 text-[10px] font-medium">LIVE</span>'
            : '<span class="px-2 py-0.5 rounded-md bg-slate-500/20 text-slate-400 text-[10px] font-medium">DEMO</span>';

          return `
            <div class="glass rounded-xl p-4 border border-slate-700/50 hover:border-blue-500/30 transition">
              <div class="flex items-start justify-between gap-4">
                <div class="flex-1">
                  <a href="${alert.url}" target="_blank" rel="noopener noreferrer"
                     class="text-slate-100 font-medium hover:text-blue-300 transition text-sm leading-snug">
                    ${alert.title}
                  </a>
                  <div class="flex items-center gap-2 mt-2">
                    <span class="px-2 py-1 rounded-md ${badgeClass} text-xs font-medium">${alert.source}</span>
                    ${modeBadge}
                    <span class="text-xs text-slate-500">${formattedDate}</span>
                  </div>
                  ${alert.keywords_matched && alert.keywords_matched.length > 0 ? `
                    <div class="flex flex-wrap gap-1 mt-2">
                      ${alert.keywords_matched.slice(0, 3).map(keyword =>
                        `<span class="text-[10px] px-2 py-0.5 rounded bg-slate-800/50 text-slate-400">${keyword}</span>`
                      ).join('')}
                    </div>
                  ` : ''}
                </div>
              </div>
            </div>
          `;
        }).join('');

      } catch (error) {
        console.error('Error loading regulatory alerts:', error);
        document.getElementById('alerts-count').textContent = '--';
        document.getElementById('alerts-summary').textContent = 'Unable to load alerts';
        document.getElementById('regulatory-alerts-list').innerHTML =
          '<p class="text-slate-400 text-sm">Unable to load regulatory alerts. Please check back later.</p>';
      }
    }

    // Initialize demo mode toggle and load all data when page loads
    initDemoMode();
    loadLatestPrice();
    loadRegulatoryAlerts();
  </script>
</body>
</html>
